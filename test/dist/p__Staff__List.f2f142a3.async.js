(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{OeR5:function(e,a,t){"use strict";var n=t("fbTi"),l=t("mZ4U");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("kqFD");var i=l(t("LKgu"));t("Ubc6");var d=l(t("far6")),r=l(t("mK77"));t("rVLg");var o=l(t("EmQR")),s=l(t("43Yg")),u=l(t("/tCh")),c=l(t("scpF")),f=l(t("O/V9")),m=l(t("8aBX"));t("880f");var h=l(t("lNJz")),p=n(t("i9FB")),g=t("LneV");t("SX54");var y=l(t("cPMy")),v=l(t("CEDc")),D=l(t("iaQY")),I=l(t("bMyU")),S=h.default.confirm,b=function(e){function a(){var e;return(0,s.default)(this,a),e=(0,c.default)(this,(0,f.default)(a).apply(this,arguments)),e.state={loading:!1,modalVisible:!1,modalData:{},imgDetailVisible:!1,imgUrl:"",selectedRowKeys:[],searchData:{name:"",status:"",startTime:"",endTime:""},pageInfo:{pageSize:10,pageNumber:1}},e.columns=[{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"phone",key:"phone"},{title:"\u8003\u8bd5\u4e8c\u7ef4\u7801",key:"img_url",render:function(a){return p.default.createElement("div",null,p.default.createElement("img",{style:{width:80,height:80},src:a.img_url,onClick:function(){e.handleShowImgDetail(a.img_url)},alt:""}))}},{title:"\u64cd\u4f5c",width:200,render:function(a){return p.default.createElement("div",{className:"table-operate"},p.default.createElement("a",{onClick:function(){return e.handleEdit(a)}},"\u4fee\u6539"),p.default.createElement("a",{onClick:function(){return e.handleDel(a.staffId)}},"\u5220\u9664"),p.default.createElement("a",{onClick:function(){return e.handleSetImg(a.staffId)}},"\u751f\u6210\u4e8c\u7ef4\u7801"))}}],e.handleTriggerModal=function(){var a=e.state.modalVisible;e.setState({modalVisible:!a})},e.handleSetImg=function(a){var t=e.props.dispatch,n=function(a){a.success?(o.default.success("\u64cd\u4f5c\u6210\u529f"),e.initData()):o.default.error(a.data)};t&&t({type:"staff/setImg",payload:{staffId:a},callback:n})},e.handleShowImgDetail=function(a){var t=e.state.imgDetailVisible;t?e.setState({imgDetailVisible:!1}):a&&e.setState({imgUrl:a,imgDetailVisible:!0})},e.getSerarchColumns=function(){var e=[{title:"\u516c\u53f8\u540d\u79f0",dataIndex:"name",componentType:"Input"}];return e},e.handleSearch=function(a){var t=e.state.searchData;e.setState({searchData:(0,r.default)({},t,a)},function(){e.initData()})},e.handleFormReset=function(){e.setState({searchData:{}},function(){e.initData()})},e.handleDel=function(a){var t=e.props.dispatch,n=function(a){a.success?(o.default.success("\u64cd\u4f5c\u6210\u529f"),e.initData()):o.default.error(a.data)};S({title:"\u7cfb\u7edf\u63d0\u793a",content:"\u786e\u8ba4\u8981\u5220\u9664\u8be5\u5458\u5de5\u5417?",onOk:function(){t&&t({type:"staff/del",payload:{staffId:a},callback:n})}})},e.handleEdit=function(a){e.setState({modalData:(0,r.default)({},a)}),e.handleTriggerModal()},e.handleAddNew=function(){e.setState({modalData:{}}),e.handleTriggerModal()},e.handleSubmitModal=function(){e.initData(),e.handleTriggerModal()},e}return(0,m.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.initData()}},{key:"initData",value:function(e){var a=this.props.dispatch,t=this.state,n=t.pageInfo,l=t.searchData,i={};for(var d in l)l[d]&&(i[d]=l[d]);e&&this.setState({pageInfo:{pageNumber:e.pageNumber,pageSize:e.pageSize}}),a&&a({type:"staff/fetch",payload:(0,r.default)({sysUserId:localStorage.getItem("sysUserId")},i,n,e)})}},{key:"render",value:function(){var e=this,a=this.props,t=a.data,n=a.loading,l=this.state,r=l.modalVisible,o=l.modalData,s=l.imgUrl,u=l.imgDetailVisible;return p.default.createElement(d.default,null,p.default.createElement("div",{className:"flex-container"},p.default.createElement("div",{className:"flex-1"},p.default.createElement(v.default,{columns:this.getSerarchColumns(),handleSearch:this.handleSearch,handleFormReset:this.handleFormReset})),p.default.createElement("div",null,p.default.createElement(i.default,{type:"primary",onClick:this.handleAddNew},"\u65b0\u589e"))),p.default.createElement(y.default,{rowKey:"staffId",columns:this.columns,data:t||[],loading:n,onChangeCombine:function(a){return e.initData(a)}}),p.default.createElement(D.default,{modalVisible:r,modalData:o,onCancel:this.handleTriggerModal,onOk:this.handleSubmitModal}),p.default.createElement(I.default,{imgUrl:s,visible:u,onCancel:this.handleShowImgDetail}))}}]),a}(p.Component),k=(0,g.connect)(function(e){var a=e.staff,t=e.loading;return{data:a.data,loading:t.models.staff}})(b);a.default=k},iaQY:function(e,a,t){"use strict";var n=t("fbTi"),l=t("mZ4U");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(t("mK77"));t("rVLg");var d=l(t("EmQR")),r=l(t("43Yg")),o=l(t("/tCh")),s=l(t("scpF")),u=l(t("O/V9")),c=l(t("8aBX")),f=n(t("i9FB")),m=t("LneV"),h=l(t("hgAY")),p=function(e){function a(){var e;return(0,r.default)(this,a),e=(0,s.default)(this,(0,u.default)(a).apply(this,arguments)),e.state={confirmLoading:!1},e.handleSubmitModal=function(a){var t=e.props,n=t.onOk,l=t.dispatch,r=t.modalData.staffId;e.setState({confirmLoading:!0});var o=function(t){t.success?d.default.success("\u64cd\u4f5c\u6210\u529f"):d.default.error(t.data),e.setState({confirmLoading:!1}),n(a)},s=r?"staff/update":"staff/add",u=r?(0,i.default)({staffId:r},a):(0,i.default)({sysUserId:localStorage.getItem("sysUserId")},a);l({type:s,payload:u,callback:o})},e}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,a=e.companyData,t=e.dispatch;0===a.length&&t({type:"staff/fetchCompany",payload:{sysUserId:localStorage.getItem("sysUserId")}})}},{key:"modalFromColumns",value:function(){var e=this.props,a=e.companyData,t=e.modalData,n=t.name,l=t.phone,i=t.sys_user_id,d=t.staffId,r=[];a&&a.forEach(function(e){r.push({value:e.company_name,id:e.id})});var o=localStorage.getItem("sysUserId"),s={};return s="1"!==o||d?null:{title:"\u6240\u5c5e\u516c\u53f8",dataIndex:"addUserId",componentType:"Select",initialValue:i,dataSource:r,requiredMessage:"\u8bf7\u9009\u62e9\u6240\u5c5e\u516c\u53f8",required:!0,placeholder:"\u8bf7\u9009\u62e9\u6240\u5c5e\u516c\u53f8"},[{title:"\u59d3\u540d",dataIndex:"name",componentType:"Input",initialValue:n,requiredMessage:"\u8bf7\u8f93\u5165\u59d3\u540d",required:!0,placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"phone",componentType:"Input",initialValue:l,requiredMessage:"\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd"},s]}},{key:"render",value:function(){var e=this.state.confirmLoading,a=this.props,t=a.modalVisible,n=a.onCancel,l=a.modalData.id;return f.default.createElement(f.Fragment,null,f.default.createElement(h.default,{title:l?"\u4fee\u6539\u8d26\u53f7":"\u65b0\u589e\u8d26\u53f7",columns:this.modalFromColumns(),onOk:this.handleSubmitModal,visible:t,confirmLoading:e,onCancel:n}))}}]),a}(f.Component),g=(0,m.connect)(function(e){var a=e.staff;return{companyData:a.companyData}})(p);a.default=g}}]);